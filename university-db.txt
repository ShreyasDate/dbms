-- ✅ Step 1: Create a new database
CREATE DATABASE university;
USE university;

-- ✅ Step 2: Create all required tables
CREATE TABLE department (
    dept_no INT,
    dept_name VARCHAR(30) UNIQUE,
    building_name VARCHAR(30),
    PRIMARY KEY (dept_no)
);

CREATE TABLE instructor (
    ins_id INT,
    ins_name VARCHAR(30) NOT NULL,
    dept_no INT,
    salary FLOAT,
    mob_no BIGINT,
    FOREIGN KEY (dept_no) REFERENCES department(dept_no)
);

CREATE TABLE course (
    course_id INT,
    title VARCHAR(30),
    dept_no INT,
    credits INT
);

CREATE TABLE teaches (
    teacher_id INT,
    course_id INT,
    semester INT,
    year INT
);

-- ✅ Step 3: Create a view (without salary column)
CREATE VIEW view_instructor AS
SELECT ins_id, ins_name, dept_no, mob_no FROM instructor;

-- ✅ Step 4: Insert sample data into department
INSERT INTO department VALUES (1, 'Computer', 'Bldg-A');
INSERT INTO department VALUES (2, 'Mechanical', 'Bldg-B');

-- ✅ Step 5: Insert records into view (auto-inserts into instructor)
INSERT INTO view_instructor VALUES (101, 'Aditi', 1, 9876543210);
INSERT INTO view_instructor VALUES (102, 'Rohan', 2, 9998887776);

-- ✅ Step 6: Update a department name
UPDATE department SET dept_name = 'IT' WHERE dept_no = 1;

-- ✅ Step 7: Delete a record through the view
DELETE FROM view_instructor WHERE ins_id = 102;

-- ✅ Step 8: Delete the last instructor record (optional)
DELETE FROM instructor ORDER BY ins_id DESC LIMIT 1;

-- ✅ Step 9: Set AUTO_INCREMENT value for course table
-- Note: AUTO_INCREMENT requires the column to be a PRIMARY KEY
ALTER TABLE course MODIFY course_id INT PRIMARY KEY AUTO_INCREMENT;
ALTER TABLE course AUTO_INCREMENT = 51;

-- ✅ Step 10: Display results
SHOW DATABASES;
SHOW TABLES;

-- ⚠️ Note: Do NOT drop tables in exam unless asked
-- DROP TABLE teaches;
